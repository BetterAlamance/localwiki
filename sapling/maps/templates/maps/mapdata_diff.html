{% extends "maps/base.html" %}
{% load diff_tags %}

{% block media %}
  {% diff old new as map_diff %}
  {{ map_diff.media }}
  <style>
    del {
      background: #FDC6C6;
      text-decoration: none;
    }
    ins {
      background: #AAFF66;
      text-decoration: none;
    }
    del img {
      border: 0.5em #FDC6C6 solid;
    }
    ins img{
      border: 0.5em #AAFF66 solid;
    }
    td.revision_details {
      font-style: italic;
    }
  </style>
  <script type="text/javascript">
    /* Always display LayerSwitcher in diff view. */
    var base_initMap = olwidget.Map.prototype.initMap;
    olwidget.Map.prototype.initMap = function(mapDivId, opts) {
        base_initMap.call(this, mapDivId, opts);
        this.addControl(new OpenLayers.Control.LayerSwitcher());
    };
  </script>

{% endblock %}

{% block title %}Differences for map on {{ new.page.name }}{% endblock %}
{% block header %}Differences for map on {{ new.page.name }}{% endblock %}

{% block main %}
  <table width="100%">
    <thead>
        <tr>
            <td class="revision_details">
                Revision {{ old.history_info.version_number }}
                ({{ old.history_info.date }}
                by {{ old.history_info.user_name|default:old.history_info.user_ip }})
            </td>
            <td class="revision_details">
                Revision {{ new.history_info.version_number }}
                ({{ new.history_info.date }}
                by {{ new.history_info.user_name|default:new.history_info.user_ip }})
            </td>
        </tr>
        <tr>
            <td>
                <del>Deletions are marked like this</del>
            </td>
            <td>
                <ins>Additions are marked like this</ins>
            </td>
        </tr>
    </thead>
    <tbody valign="top">
    {% diff old new as map_diff %}
    {{ map_diff.geom }} 
    </tbody>
  </table>
  <p>
      <a href="{% url show-page-map slug=object.page.pretty_slug %}">View map</a>
  </p>
{% endblock %}
